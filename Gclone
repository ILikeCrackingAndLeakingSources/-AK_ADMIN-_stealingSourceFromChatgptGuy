local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local Mouse = Player:GetMouse()
local Workspace = game:GetService("Workspace")
local Terrain = Workspace.Terrain

-- Clone settings
getgenv().CloneSettings = {
    Enabled = false,
    Bind = "G",       -- The keybind to toggle the clone functionality
    Value = 15,       -- The value for the clone offset
    Delay = 0.05      -- The delay between clone actions
}

-- Teleport function
local function teleportToMouse()
    local character = Player.Character
    if character then
        local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
        if humanoidRootPart then
            local mousePosition = Mouse.Hit.Position
            humanoidRootPart.CFrame = CFrame.new(mousePosition + Vector3.new(0, 3, 0))
        end
    end
end

-- Detect keypresses for teleport and clone
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end

    -- Teleport when "F" is pressed
    if input.KeyCode == Enum.KeyCode.F then
        teleportToMouse()
    end

    -- Toggle CloneSettings.Enabled when the "G" key is pressed
    if input.KeyCode == Enum.KeyCode[getgenv().CloneSettings.Bind] then
        getgenv().CloneSettings.Enabled = not getgenv().CloneSettings.Enabled
    end
end)

-- Loop to handle the clone behavior when enabled
while task.wait() do
    pcall(function()
        if getgenv().CloneSettings.Enabled then
            local cOld = Player.Character.HumanoidRootPart.CFrame

            -- Clone movement logic
            Player.Character.HumanoidRootPart.CFrame = Player.Character.HumanoidRootPart.CFrame * CFrame.new(-getgenv().CloneSettings.Value, 0, 0)
            task.wait(getgenv().CloneSettings.Delay)
            Player.Character.HumanoidRootPart.CFrame = cOld
            task.wait(getgenv().CloneSettings.Delay)
            Player.Character.HumanoidRootPart.CFrame = Player.Character.HumanoidRootPart.CFrame * CFrame.new(getgenv().CloneSettings.Value, 0, 0)
            task.wait(getgenv().CloneSettings.Delay)
            Player.Character.HumanoidRootPart.CFrame = cOld
        end
    end)
end
