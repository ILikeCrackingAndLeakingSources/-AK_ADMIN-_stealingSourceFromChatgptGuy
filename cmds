-- Services
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

-- Player
local localPlayer = Players.LocalPlayer
local mouse = localPlayer:GetMouse()

-- Constants and Colors
local COLORS = {
    main = Color3.fromRGB(35, 40, 55),
    secondary = Color3.fromRGB(45, 50, 65),
    accent = Color3.fromRGB(65, 70, 85),
    hover = Color3.fromRGB(75, 80, 95),
    text = Color3.fromRGB(240, 240, 255),
    textDim = Color3.fromRGB(180, 190, 210)
}

local TWEEN_INFO = {
    fast = TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
    medium = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
    slow = TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
}

-- GUI Setup
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "CustomGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = localPlayer:WaitForChild("PlayerGui")

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 300, 0, 400)
frame.BackgroundColor3 = COLORS.main
frame.Position = UDim2.new(0.3, 0, 0.3, 0)
frame.Parent = screenGui
frame.ClipsDescendants = true -- Add clipping for smooth animations

local frameCorner = Instance.new("UICorner")
frameCorner.CornerRadius = UDim.new(0, 8)
frameCorner.Parent = frame

-- Add smooth shadow
local shadow = Instance.new("ImageLabel")
shadow.Size = UDim2.new(1, 40, 1, 40)
shadow.Position = UDim2.new(0, -20, 0, -20)
shadow.BackgroundTransparency = 1
shadow.Image = "rbxassetid://5554236805"
shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
shadow.ImageTransparency = 0.6
shadow.Parent = frame

local header = Instance.new("Frame")
header.Size = UDim2.new(1, 0, 0, 40)
header.BackgroundColor3 = COLORS.secondary
header.Parent = frame

local headerCorner = Instance.new("UICorner")
headerCorner.CornerRadius = UDim.new(0, 8)
headerCorner.Parent = header

local headerText = Instance.new("TextLabel")
headerText.Size = UDim2.new(1, -100, 1, 0)
headerText.Position = UDim2.new(0, 10, 0, 0)
headerText.Text = "AK COMMANDS"
headerText.Font = Enum.Font.GothamBold
headerText.TextSize = 18
headerText.TextColor3 = COLORS.text
headerText.TextXAlignment = Enum.TextXAlignment.Left
headerText.BackgroundTransparency = 1
headerText.Parent = header

-- Enhanced button styles
local function createStyledButton(name, size, position, parent)
    local button = Instance.new("TextButton")
    button.Size = size
    button.Position = position
    button.BackgroundColor3 = COLORS.accent
    button.BorderSizePixel = 0
    button.Text = name
    button.Font = Enum.Font.GothamBold
    button.TextSize = 20
    button.TextColor3 = COLORS.text
    button.Parent = parent
    button.AutoButtonColor = false

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 4)
    corner.Parent = button

    -- Hover and click animations
    button.MouseEnter:Connect(function()
        TweenService:Create(button, TWEEN_INFO.fast, {
            BackgroundColor3 = COLORS.hover
        }):Play()
    end)
    
    button.MouseLeave:Connect(function()
        TweenService:Create(button, TWEEN_INFO.fast, {
            BackgroundColor3 = COLORS.accent
        }):Play()
    end)

    button.MouseButton1Down:Connect(function()
        TweenService:Create(button, TWEEN_INFO.fast, {
            Size = size - UDim2.new(0, 2, 0, 2),
            Position = position + UDim2.new(0, 1, 0, 1)
        }):Play()
    end)

    button.MouseButton1Up:Connect(function()
        TweenService:Create(button, TWEEN_INFO.fast, {
            Size = size,
            Position = position
        }):Play()
    end)

    return button
end

local minimizeButton = createStyledButton("-", UDim2.new(0, 30, 0, 30), UDim2.new(1, -70, 0, 5), header)
local closeButton = createStyledButton("X", UDim2.new(0, 30, 0, 30), UDim2.new(1, -35, 0, 5), header)

-- Enhanced search container
local searchContainer = Instance.new("Frame")
searchContainer.Size = UDim2.new(1, -20, 0, 30)
searchContainer.Position = UDim2.new(0, 10, 0, 50)
searchContainer.BackgroundColor3 = COLORS.secondary
searchContainer.Parent = frame

local searchCorner = Instance.new("UICorner")
searchCorner.CornerRadius = UDim.new(0, 8)
searchCorner.Parent = searchContainer

local searchBox = Instance.new("TextBox")
searchBox.Size = UDim2.new(1, -20, 1, -10)
searchBox.Position = UDim2.new(0, 10, 0, 5)
searchBox.PlaceholderText = "Search Commands..."
searchBox.Font = Enum.Font.Gotham
searchBox.TextSize = 14
searchBox.TextColor3 = COLORS.text
searchBox.PlaceholderColor3 = COLORS.textDim
searchBox.BackgroundTransparency = 1
searchBox.BorderSizePixel = 0
searchBox.ClearTextOnFocus = false
searchBox.Text = ""
searchBox.Parent = searchContainer

-- Enhanced scrolling frame
local scrollFrame = Instance.new("ScrollingFrame")
scrollFrame.Size = UDim2.new(1, -20, 1, -100)
scrollFrame.Position = UDim2.new(0, 10, 0, 90)
scrollFrame.BackgroundColor3 = COLORS.secondary
scrollFrame.ScrollBarThickness = 4
scrollFrame.ScrollBarImageColor3 = COLORS.accent
scrollFrame.BorderSizePixel = 0
scrollFrame.Parent = frame

local scrollCorner = Instance.new("UICorner")
scrollCorner.CornerRadius = UDim.new(0, 8)
scrollCorner.Parent = scrollFrame

local uiListLayout = Instance.new("UIListLayout")
uiListLayout.SortOrder = Enum.SortOrder.LayoutOrder
uiListLayout.Padding = UDim.new(0, 5)
uiListLayout.Parent = scrollFrame

-- Enhanced command button template
local function createCommandButton(name, description)
    local button = Instance.new("TextButton")
    button.BackgroundColor3 = COLORS.secondary
    button.BorderSizePixel = 0
    button.Name = name
    button.Text = ""
    button.AutoButtonColor = false
    
    local buttonCorner = Instance.new("UICorner")
    buttonCorner.CornerRadius = UDim.new(0, 8)
    buttonCorner.Parent = button
    
    local cmdName = Instance.new("TextLabel")
    cmdName.Size = UDim2.new(1, -20, 0, 20)
    cmdName.Position = UDim2.new(0, 10, 0, 5)
    cmdName.Text = name
    cmdName.Font = Enum.Font.GothamBold
    cmdName.TextSize = 14
    cmdName.TextColor3 = COLORS.text
    cmdName.TextXAlignment = Enum.TextXAlignment.Left
    cmdName.BackgroundTransparency = 1
    cmdName.Parent = button
    
    local cmdDesc = Instance.new("TextLabel")
    cmdDesc.Font = Enum.Font.Gotham
    cmdDesc.TextSize = 9
    cmdDesc.TextColor3 = COLORS.textDim
    cmdDesc.TextXAlignment = Enum.TextXAlignment.Left
    cmdDesc.BackgroundTransparency = 1
    cmdDesc.TextWrapped = true
    cmdDesc.Parent = button
    cmdDesc.Text = description
    
    -- Dynamic sizing based on text content
    local function updateSize()
        local textSize = game:GetService("TextService"):GetTextSize(
            description,
            cmdDesc.TextSize,
            cmdDesc.Font,
            Vector2.new(button.AbsoluteSize.X - 20, math.huge)
        )
        
        cmdDesc.Size = UDim2.new(1, -20, 0, textSize.Y)
        cmdDesc.Position = UDim2.new(0, 10, 0, 25)
        button.Size = UDim2.new(1, -10, 0, textSize.Y + 40)
    end
    
    button.Parent = scrollFrame
    updateSize()
    
    -- Hover animations
    button.MouseEnter:Connect(function()
        TweenService:Create(button, TWEEN_INFO.fast, {
            BackgroundColor3 = COLORS.accent
        }):Play()
    end)
    
    button.MouseLeave:Connect(function()
        TweenService:Create(button, TWEEN_INFO.fast, {
            BackgroundColor3 = COLORS.secondary
        }):Play()
    end)
    
    return button
end

-- Enhanced drag functionality
local dragging, dragStart, startPos
local dragInput

local function updateDrag(input)
    local delta = input.Position - dragStart
    local position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X,
                              startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    TweenService:Create(frame, TWEEN_INFO.fast, {Position = position}):Play()
end

header.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = frame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        updateDrag(input)
    end
end)

header.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or
       input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)

-- Enhanced minimize/maximize animation
local minimized = false
minimizeButton.MouseButton1Click:Connect(function()
    minimized = not minimized
    local targetSize = minimized and UDim2.new(0, 300, 0, 40) or UDim2.new(0, 300, 0, 400)
    
    TweenService:Create(frame, TWEEN_INFO.medium, {
        Size = targetSize
    }):Play()
    
    -- Fade animations for content
    local transparency = minimized and 1 or 0
    local contentItems = {searchContainer, scrollFrame}
    
    for _, item in ipairs(contentItems) do
        TweenService:Create(item, TWEEN_INFO.fast, {
            BackgroundTransparency = transparency
        }):Play()
        
        task.delay(minimized and 0 or 0.2, function()
            item.Visible = not minimized
        end)
    end
end)

-- Enhanced close animation
closeButton.MouseButton1Click:Connect(function()
    -- Fade out animation
    local fadeOut = TweenService:Create(frame, TWEEN_INFO.medium, {
        BackgroundTransparency = 1,
        Size = UDim2.new(0, 0, 0, 0),
        Position = UDim2.new(frame.Position.X.Scale, frame.Position.X.Offset + 150,
                            frame.Position.Y.Scale, frame.Position.Y.Offset + 200)
    })
    
    -- Fade out shadow
    TweenService:Create(shadow, TWEEN_INFO.medium, {
        ImageTransparency = 1
    }):Play()
    
    fadeOut.Completed:Connect(function()
        screenGui:Destroy()
    end)
    
    fadeOut:Play()
end)

-- Add commands
local function addCommand(name, description)
    createCommandButton(name, description)
end

-- Update canvas size
local function updateCanvasSize()
    local contentHeight = uiListLayout.AbsoluteContentSize.Y
    local padding = 10
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, contentHeight + padding)
end

scrollFrame:GetPropertyChangedSignal("AbsoluteSize"):Connect(updateCanvasSize)
uiListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(updateCanvasSize)

-- Search functionality
searchBox:GetPropertyChangedSignal("Text"):Connect(function()
    local searchText = searchBox.Text:lower()
    for _, button in ipairs(scrollFrame:GetChildren()) do
        if button:IsA("TextButton") then
            local shouldShow = button.Name:lower():find(searchText, 1, true) ~= nil
            
            -- Smooth fade animation
            TweenService:Create(button, TWEEN_INFO.fast, {
                BackgroundTransparency = shouldShow and 0 or 1,
                TextTransparency = shouldShow and 0 or 1
            }):Play()
            
            task.delay(shouldShow and 0 or 0.2, function()
                button.Visible = shouldShow
            end)
        end
    end
    updateCanvasSize()
end)
-- Add sample commands
addCommand("!bring", "Executes a bring GUI that brings the players by floating under them.")
addCommand("!antilag", "Prevents lagging.")
addCommand("!antibang", "Prevents other exploiters from banging you.")
addCommand("!chaoshub", "Just a random hub.")
addCommand("!aimbot", "The command already explains.")
addCommand("!protonadmin", "Just another Admin script.")
addCommand("!walkonwalls", "Rewrites gravity and lets you walk on any surface.")
addCommand("!unanchorfling", "Go near unanchored parts and fling the target with it.")
addCommand("!chatquiz", "Allows you to chat quizzes with other players.")
addCommand("!invis", "Invisibility toggle.")
addCommand("!f3x sun", "The same game as .f3x.")
addCommand("!f3x triangle", "The same game as .f3x.")
addCommand("!f3x house", "The same game as .f3x.")
addCommand("!f3x ufo", "The same game as .f3x.")
addCommand("!shiftlock", "Shiftlock for mobile.")
addCommand("!nofriends", "Automatically server hops if a friend joins.")
addCommand("!getoutmyinv", "Drops all your items at once.")
addCommand("!platespin", "Orange plates spin around you. Click on the plates for it to work.")
addCommand("!fling all", "Loop flings everyone.")
addCommand("!gimmetools", "Picks up every tool dropped by a player in the server.")
addCommand("!givepower (display name)", "Gives the player you wish warning power.")
addCommand("!oof", "Respawns you and teleports you back to the same position.")
addCommand("!cmds", "The GUI for this script.")
addCommand("!antilog", "Prevents the game from logging your chat and screenshots.")
addCommand("!donttouchme", "Flings everyone that touches you.")
addCommand("!serverhop", "Hops servers.")
addCommand("!afk", "Prevents being kicked while AFK.")
addCommand("!ftao", "For the game (Fling Things and Others).")
addCommand("!iy", "Infinite yield admin.")
addCommand("!emoji", "Enables chatting emojis like Discord (:skull).")
addCommand("!f3x", "For (Sword Fights on the Heights Original). Controls orange plates.")
addCommand("!bypasser", "Bypasses the chat filter.")
addCommand("!bladeball", "A bladeball script.")
addCommand("!nonofling", "Prevents other players from flinging you.")
addCommand("!swordreach", "Explains itself.")
addCommand("!byebye all", "Flings everyone once.")
addCommand("!pltiger", "A script for Prison Life.")
addCommand("!fps", "Boosts FPS.")
addCommand("!rejoin", "Rejoin the game.")
addCommand("!clearchat", "Clears the chat.")
addCommand("!cmdbar", "A command bar for executing commands without using chat.")
addCommand("!jobidjoiner", "Join a player by entering game ID and job ID.")
addCommand("!walkonvoid", "Prevents you from dying by falling into the void.")
addCommand("!hkill all", "Kills everyone with a sword that does damage.")
addCommand("!serverhopmost", "Server hops to the server with the most players.")
addCommand("!antiheadsit", "Self-explained.")
addCommand("!antivoid", "Deletes the void.")
addCommand("!dropkick", "Performs a dropkick on nearby players.")
addCommand("!serverhoplow", "Server hops to a low-populated server.")
addCommand("!walkonair", "Adds an invisible baseplate.")
addCommand("!copy <target>", "Copy the avatar of the target (MIC UP).")
addCommand("!chatbot", "Join Discord, claim points, and enter the key.")
addCommand("!rainbowmic", "Gets the rainbow mic from the vending machine.")
addCommand("!rainbowdonut", "Gets the rainbow donut from the vending machine.")
addCommand("!demonmic", "Gets the demon mic from the vending machine.")
addCommand("!tptoplr", "TP to player tool.")
addCommand("!stopglide", "Removes sliding when walking fast.")
addCommand("!lookat", "Look at player of choice.")
addCommand("!unlookat", "Stops looking.")
addCommand("!goto", "Teleport to player of choice.")
addCommand("!superfly", "Become Superman (better on R15).")
addCommand("!remotechecker", "Fire any remote with a GUI.")
addCommand("!animhub", "Use any animation and troll.")
addCommand("!copynearest", "Copies nearest in Mic Up.")
addCommand("!sneak", "Go up and down.")
addCommand("!mobilesuperfly", "Superfly for mobile.")
addCommand("!catchme", "Makes you unmutable.")
addCommand("!stand <target>", "Makes you a JoJo stand.")
addCommand("!unstand", "Removes your JoJo stand.")
addCommand("!antiall", "click on the button and kill the person who is banging you or anything else")
addCommand("!antiall2", "antiall made for MIC UP!")
addCommand("!r6", "")
addCommand("!r15", "")
addCommand("!trail", "click on the button and kill the person who is banging you or anything else")
addCommand("!scan map", "scans map for micup with admin gamepass")
addCommand("!unscan", "stop scan map")
addCommand("!steal", "steal any avi need to own hats of avi tho")
addCommand("!mutenonfriends", "mutes everyone but your friends")
addCommand("!reactivatevc", "Use on an alt account if you don't care about being TERMINATED. To use this, get your voice suspended, then execute the command")
addCommand("!chatlogs", "View chat logs")
addCommand("!errornotify", "Notifies you every time you execute an error")
addCommand("!akhub", "A very cool hub with lots of FE stuff")
addCommand("!chattroll", "Troll with funny messages")
addCommand("!jerk", "A command with unspecified functionality")
addCommand("!shapshifter", "Only for R6!")
addCommand("!dex", "Dex explorer")
addCommand("!vcbypass", "not 100% be careful")
addCommand("!bodyinvis", "only works on MIC UP")
addCommand("!facebang", "keybind is Z (Y for European)")
addCommand("!hug", "keybind is H")
addCommand("!invistroll display name/username", "makes u invisible and follows the target. ONLY IN MIC UP!")
addCommand("!antikick", "only works in good executors!")
addCommand("!unctest", "UNC TEST")
addCommand("!jumpingrope", "need 3D Pants! Only works in MIC UP!")
addCommand("!akbypasser", "chat bypasser made by us!")
addCommand("!animlogger", "gets the animation IDS you are playing!")
addCommand("!blockmap", "only in MIC UP! (need 3D Clothing!)")

-- Initialize the GUI
updateCanvasSize()

-- Add smooth fade-in animation on startup
frame.BackgroundTransparency = 1
shadow.ImageTransparency = 1
searchContainer.BackgroundTransparency = 1
scrollFrame.BackgroundTransparency = 1

-- Delay the animation slightly for a smoother appearance
task.delay(0.1, function()
    -- Fade in main frame
    TweenService:Create(frame, TWEEN_INFO.medium, {
        BackgroundTransparency = 0
    }):Play()
    
    -- Fade in shadow
    TweenService:Create(shadow, TWEEN_INFO.medium, {
        ImageTransparency = 0.6
    }):Play()
    
    -- Fade in containers
    for _, container in ipairs({searchContainer, scrollFrame}) do
        TweenService:Create(container, TWEEN_INFO.medium, {
            BackgroundTransparency = 0
        }):Play()
    end
    
    -- Fade in command buttons sequentially
    for i, button in ipairs(scrollFrame:GetChildren()) do
        if button:IsA("TextButton") then
            button.BackgroundTransparency = 1
            for _, child in ipairs(button:GetChildren()) do
                if child:IsA("TextLabel") then
                    child.TextTransparency = 1
                end
            end
            
            -- Create sequential fade-in effect
            task.delay(i * 0.05, function()
                TweenService:Create(button, TWEEN_INFO.medium, {
                    BackgroundTransparency = 0
                }):Play()
                
                for _, child in ipairs(button:GetChildren()) do
                    if child:IsA("TextLabel") then
                        TweenService:Create(child, TWEEN_INFO.medium, {
                            TextTransparency = 0
                        }):Play()
                    end
                end
            end)
        end
    end
end)

return screenGui
